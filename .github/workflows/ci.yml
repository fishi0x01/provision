---
name: CI
on:
  push:
    branches:
      - master
  pull_request:

jobs:
  build:
    runs-on: ubuntu-22.04
    container:
      image: fedora:38
      # options: --user 1000
    steps:
      - name: Install required packages
        run: dnf install -y xz util-linux
      - name: Add machine user
        run: useradd fishi0x01
      - name: Make sudo
        run: echo "fishi0x01 ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers;
      - name: Checkout Code
        uses: actions/checkout@v3
      - name: Switch user
        run: su - fishi0x01
      - name: Install nix
        run: ${GITHUB_WORKSPACE}/scripts/install/install-nix.sh;
        #. /home/fishi0x01/.nix-profile/etc/profile.d/nix.sh;
        #make install-dotfiles;
        #make delete-dotfiles;
        #./scripts/delete/delete-nix.sh;
